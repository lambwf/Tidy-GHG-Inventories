"0",""
"0",""
"0","#colors <- c(""#365f90ff"", ""#4672b3ff"", ""#659cccff"", ""#a3d3f7ff"", ""#6ccac8ff"", ""#e5b82cff"", ""#4f8455ff"", ""#6aad75ff"", ""#818181ff"")"
"0",""
"0",""
"0","data_plots <- data_crts %>% "
"0","  left_join(.,read.xlsx(""data/cc_inventory_sectors.xlsx"",sheet=2) %>% select(sector_code,sector_tidy)) %>% "
"0","  group_by(country,iso,year,sector_tidy) %>% "
"0","  summarise(value=sum(value,na.rm=T)/1e6)"
"2","[38;5;232mJoining with `by = join_by(sector_code)`[39m
"
"2","[38;5;232m`summarise()` has grouped output by 'country', 'iso', 'year'. You can override using the `.groups` argument.[39m
"
"0","data_plots <- data_plots %>% "
"0","  mutate(sector_tidy = as.factor(sector_tidy)) %>% "
"0","  mutate(sector_tidy = fct_relevel(sector_tidy,"
"0","                                   ""Energy | Power"","
"0","                                   ""Energy | Industry"","
"0","                                   ""Energy | Transport"","
"0","                                   ""Energy | Buildings & other"","
"0","                                   ""Energy | Fuel production"","
"0","                                   ""Industrial processes"","
"0","                                   ""Agriculture"","
"0","                                   ""Land use change (LULUCF)"","
"0","                                   ""Waste""))"
"0",""
"0","countries = unique(data_plots$country)"
"0","for (i in 1:length(countries)) {"
"0","  "
"0","  data <- data_plots %>% "
"0","  filter(country == countries[i])"
"0","  "
"0","  total <- data %>% "
"0","    group_by(year) %>% "
"0","    summarise(value=sum(value))"
"0","  "
"0","  p <- data %>% "
"0","  ggplot(.,aes(x=year,y=value,fill=sector_tidy)) +"
"0","  geom_col(color='#252525',linewidth=0.25,width=1) +"
"0","  geom_path(data=total,inherit.aes = FALSE,aes(x=year,y=value),size=1,colour='#252525') +"
"0","  geom_point(data=total,inherit.aes = FALSE,aes(x=year,y=value),size=1.75,shape=21,fill=""white"",colour='#252525') +"
"0","  theme_wl_bar_trend() + "
"0","  scale_fill_manual(values=colours_9_sectors) +"
"0","  scale_x_continuous(limits=c(1989,max(data_plots$year)+1),"
"0","                       expand = expansion(mult = c(0.01, 0.01)),"
"0","                     breaks=c(1990,2000,2010,max(data_plots$year))) +"
"0","  theme(axis.title = element_blank()) +"
"0","  labs(title=paste0(countries[i]),"
"0","       subtitle=expression(""Greenhouse gas emissions inventory (MtCO""[2]*""e/yr)""),"
"0","       caption=""âŒ‚ UNFCCC   âŒ‚ Tidy GHG inventories   âŒ‚ GWP100 AR5   âŒ‚ CC-BY William F. Lamb"")"
"0",""
"0","  "
"0","  ggsave(paste0(""plots/countries/"",countries[i],"".png""), plot = p, device = ""png"", dpi = 300, width = 8, height = 4)"
"0","  ggsave(paste0(""plots/countries/"",countries[i],"".pdf""), plot = p, device = cairo_pdf, width = 8, height = 4)"
"0","  ggsave(paste0(""plots/countries/"",countries[i],"".svg""), plot = p, device = ""svg"", width = 8, height = 4)"
"0",""
"0","  data <- data %>% "
"0","    mutate(units=""MtCO2e (GWP100 AR5)"") %>% "
"0","    select(country,iso,sector=sector_tidy,year,units,value)"
"0","  "
"0","  "
"0","  ## Save data"
"0","  "
"0","  wb <- createWorkbook()"
"0","  addWorksheet(wb,""info"")"
"0","  addWorksheet(wb,""data"")"
"0","  info = data.frame(a=c(""Author"",""Contact"",""Data sources"",""See also""),"
"0","                    b=c(""William F. Lamb"","
"0","                        ""william.lamb@pik-potsdam.de"","
"0","                        ""Lamb, W. F. (2025). Tidy GHG Inventories (1.0) [Data set]. Zenodo. https://doi.org/10.5281/zenodo.14945466"","
"0","                        ""https://doi.org/10.5281/zenodo.14512139""))"
"0","  "
"0","  writeData(wb, sheet = ""info"",info,colNames = F, rowNames = F)"
"0","  writeData(wb, sheet = ""data"",data,colNames = T, rowNames = F)"
"0","  "
"0","  saveWorkbook(wb,paste0(""plots/countries/plot data/"",countries[i],"".xlsx""),overwrite=T)"
"0","  "
"0","  "
"0","}"
"0",""
"0",""
