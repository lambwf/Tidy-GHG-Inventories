"0",""
"0",""
"0","load(""sources/data_crt_files.RData"")"
"0",""
"0","files <- files_crts %>% "
"0","  select(iso,country,dir,year_submission) %>% "
"0","  distinct() %>% "
"0","  mutate(file=paste0(country,""_"",year_submission))"
"0",""
"0","files <- files %>% "
"0","  group_by(iso) %>% "
"0","  mutate(no_versions=n()) %>% "
"0","  filter(no_versions>1)"
"0",""
"0","## Compile"
"0",""
"0","data_compare <- data.frame()"
"0",""
"0","for (i in 1:length(files$file)) {"
"0","  "
"0","  temp_env <- new.env()"
"0","  load(paste0(""sources/compiled/"",files$file[i],"".RData""), envir = temp_env)"
"0",""
"0","  data_compare <- rbind(data_compare,temp_env$data)"
"0",""
"0","}"
"0",""
"0",""
"0","data_plots <- data_compare %>% "
"0","  group_by(country,iso,year,year_submission) %>% "
"0","  summarise(value=sum(value,na.rm=TRUE)/1e6)"
"2","[38;5;232m`summarise()` has grouped output by 'country', 'iso', 'year'. You can override using the `.groups` argument.[39m
"
"0","countries = unique(data_plots$country)"
"0",""
"0",""
"0","for (i in 1:length(countries)) {"
"0","  "
"0","  data <- data_plots %>% "
"0","  filter(country == countries[i])"
"0","  "
"0","  "
"0","  p <- data %>% "
"0","  ggplot(.,aes(x=year,y=value,colour=year_submission)) +"
"0","  geom_path(size=1) +"
"0","  geom_point(size=1.75,shape=21,fill=""white"") +"
"0","  theme_wl_bar_trend() + "
"0","  scale_colour_manual(values=c(""#ff9055ff"",""#659cccff"")) +"
"0","  scale_x_continuous(limits=c(1989,max(data_plots$year)+1),"
"0","                       expand = expansion(mult = c(0.01, 0.01)),"
"0","                     breaks=c(1990,2000,2010,max(data_plots$year))) +"
"0","  scale_y_continuous(limits = c(0, NA)) +"
"0","  "
"0","  theme(axis.title = element_blank()) +"
"0","  labs(title=paste0(countries[i]),"
"0","       subtitle=expression(""Greenhouse gas emissions inventory (MtCO""[2]*""e/yr)""),"
"0","       caption=""âŒ‚ UNFCCC   âŒ‚ Tidy GHG inventories   âŒ‚ GWP100 AR5   âŒ‚ CC-BY William F. Lamb"")"
"0",""
"0","  # p2 <- data %>% "
"0","  #   group_by(year_submission) %>% "
"0","  #   summarise(value=last(value)) %>% "
"0","  # ggplot(.,aes(x=1,y=value,colour=year_submission,label=year_submission)) +"
"0","  # geom_text_repel("
"0","  #   hjust=0,"
"0","  #   direction = ""y"","
"0","  #   point.size = NA,"
"0","  #   size=3.5,"
"0","  #   show.legend = FALSE,"
"0","  #   min.segment.length = Inf,"
"0","  #   box.padding = 0.2,"
"0","  #   force = 0.1) +"
"0","  # scale_colour_manual(values=colours_gases) +"
"0","  # scale_x_continuous(expand = expansion(mult = c(0, 0.05))) +"
"0","  #   scale_y_continuous(limits = c(0, NA)) +"
"0","  # theme_wl_empty()"
"0","  # "
"0","  # plot <- p1 + p2 + plot_layout(widths=c(5,1.55))"
"0","  # plot"
"0",""
"0","  "
"0","  ggsave(paste0(""plots/countries/versions/"",countries[i],""-versions.png""), plot = p, device = ""png"", dpi = 300, width = 7, height = 4)"
"0","  ggsave(paste0(""plots/countries/versions/"",countries[i],""-versions.pdf""), plot = p, device = cairo_pdf, width = 7, height = 4)"
"0","  ggsave(paste0(""plots/countries/versions/"",countries[i],""-versions.svg""), plot = p, device = ""svg"", width = 7, height = 4)"
"0","  "
"0",""
"0",""
"0","  "
"0","}"
"0",""
"0",""
"0",""
