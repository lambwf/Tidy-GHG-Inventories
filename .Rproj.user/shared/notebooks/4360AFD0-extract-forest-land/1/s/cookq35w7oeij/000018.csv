"0",""
"0","files_to_extract <- files_crts %>%"
"0","  arrange(iso,year_file) %>% "
"0","  filter(is.na(forest_land_extracted))"
"0","  "
"0",""
"0",""
"0","## prepare data frames"
"0",""
"0","data_land_area <- data.frame()"
"0",""
"0","i=2"
"0",""
"0","for (i in 1:length(files_to_extract$file)) {"
"0","  "
"0","  table <- read.xlsx(xlsxFile = paste0(""sources/done/"",files_to_extract$dir[i],""/"",files_to_extract$files[i]),"
"0","                       sheet = paste0(""Table4.1""),"
"0","                       startRow = 8)"
"0","  "
"0","  table <- table %>% "
"0","    rename(area_from=`TO:`) %>% "
"0","    filter(!str_detect(area_from, ""^\\("")) %>% "
"0","    filter(!str_detect(area_from, ""FROM:"")) %>% "
"0","    filter(!str_detect(area_from, ""Note:"")) %>% "
"0","    mutate(area_from = str_remove_all(area_from, ""\\(\\d+\\)"")) %>% "
"0","    gather(area_to,value,-area_from)"
"0","  "
"0","  "
"0","  table$area_to=gsub(""\\."","" "",table$area_to)"
"0","  "
"0","  table <- table %>% "
"0","    mutate(year=files_to_extract$year_file[i]) %>% "
"0","    mutate(year_submission=files_to_extract$year_submission[i]) %>% "
"0","    mutate(iso=files_to_extract$iso[i])"
"0","  "
"0","  table <- table %>% "
"0","    select(iso,year_submission,year,area_from,area_to,value)"
"0","  "
"0","  ## bind to dataset"
"0","  data_land_area <- bind_rows(data_land_area,table)"
"0","  "
"0","}"
"0","  "
"0","  "
"0","  "
"0","  "
"0","  "
