"0",""
"0","zips <- data.frame(dir=list.files(path = ""sources/new/"", pattern = ""\\.zip$"", full.names = TRUE))"
"0",""
"0","for (zip_file in zips$dir) {"
"0","  # Get the directory path and the base name of the zip file"
"0","  dir_path <- dirname(zip_file)"
"0","  base_name <- file_path_sans_ext(basename(zip_file))"
"0",""
"0","  # Create a new directory for the zip file"
"0","  new_dir <- file.path(dir_path, base_name)"
"0","  dir.create(new_dir, showWarnings = FALSE)"
"0",""
"0","  # Extract the zip file into the new directory"
"0","  unzip(zipfile = zip_file, exdir = new_dir)"
"0",""
"0","  # List all files in the new directory"
"0","  extracted_files <- list.files(new_dir, recursive = TRUE, full.names = TRUE)"
"0",""
"0","  # Check if all extracted files are .xlsx files"
"0","  non_xlsx_files <- extracted_files[!grepl(""\\.xlsx$"", extracted_files)]"
"0","  if (length(non_xlsx_files) > 0) {"
"0","    warning(paste(""Non-.xlsx files found in:"", new_dir))"
"0","  }"
"0","}"
"0",""
"0","## Delete the extracted zip files"
"0",""
"0","for (zip_file in zips$dir) {"
"0","  file.remove(zip_file)"
"0","}"
"0",""
"0",""
"0",""
"0","## unzip every folder in a folder... (some special cases)"
"0","# special_folder <- data.frame(dir=list.files(path = ""sources/new/EU_CRT_1990_2023/zipped"", pattern = ""\\.zip$"", full.names = TRUE))"
"0","# "
"0","# for (zip_file in special_folder$dir) {"
"0","#   "
"0","#   unzip(zipfile = zip_file, exdir = ""sources/new/EU_CRT_1990_2023"")"
"0","#   "
"0","# }"
"0","  "
"0",""
