"0",""
"0","folders <- data.frame(dir=list.files(path = ""sources/new/""))"
"0","new_crt_files = data.frame(dir=NA,files=NA,country=NA,year_file=NA,year_submission=NA,status=NA)"
"0",""
"0","for (i in 1:length(folders$dir)) {"
"0","  "
"0","  files <- data.frame(dir=folders$dir[i],"
"0","                      files=list.files(path = paste0(""sources/new/"",folders$dir[i])),"
"0","                      year_file=NA,"
"0","                      country=NA,"
"0","                      year_submission=NA,"
"0","                      status=""compiled"")"
"0","  "
"0","  for (j in 1:length(files$files)) {"
"0","    "
"0","    ## Extract the country name, file year and submission year from the top of Table1 in every sheet"
"0","    "
"0","    file_info <- read.xlsx(xlsxFile = paste0(""sources/new/"",folders$dir[i],""/"",files$files[j]),"
"0","                           sheet = paste0(""Table1""),rows = 1:3,colNames = FALSE)"
"0","    "
"0","    files$year_file[j] <- str_extract(file_info$X2[1], ""\\d{4}"")"
"0","    files$year_submission[j] <- str_extract(file_info$X2[2], ""\\d{4}"")"
"0","    files$country[j] <- file_info$X2[3]"
"0","    "
"0","  }"
"0","  "
"0","  new_crt_files <- rbind(new_crt_files,files)"
"0","  "
"0","}"
"0",""
"0","new_crt_files <- new_crt_files %>% "
"0","  filter(!is.na(dir)) %>% "
"0","  mutate(iso=countrycode(country,""country.name"",""iso3c"")) %>% "
"0","  mutate(country=countrycode(iso,""iso3c"",""country.name""))"
"0",""
"0",""
"0","## check for issues"
"0",""
"0","check <- new_crt_files %>% "
"0","  filter(is.na(country) | is.na(year_file) | is.na(year_submission))"
"0",""
"0",""
"0",""
